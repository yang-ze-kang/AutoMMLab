import os
import sys
sys.path.append(os.path.dirname(os.path.abspath(__file__)))
from base_coco import DatasetBaseCoCo
from nltk.corpus import wordnet

from autommlab.configs import DATASET_ZOO

class DatasetObject365Detection(DatasetBaseCoCo):

    CLASSES = ['person', 'sneakers', 'chair', 'hat', 'lamp', 'bottle',
         'cabinet/shelf', 'cup', 'car', 'glasses', 'picture/frame', 'desk',
         'handbag', 'street lights', 'book', 'plate', 'helmet',
         'leather shoes', 'pillow', 'glove', 'potted plant', 'bracelet',
         'flower', 'tv', 'storage box', 'vase', 'bench', 'wine glass', 'boots',
         'bowl', 'dining table', 'umbrella', 'boat', 'flag', 'speaker',
         'trash bin/can', 'stool', 'backpack', 'couch', 'belt', 'carpet',
         'basket', 'towel/napkin', 'slippers', 'barrel/bucket', 'coffee table',
         'suv', 'toy', 'tie', 'bed', 'traffic light', 'pen/pencil',
         'microphone', 'sandals', 'canned', 'necklace', 'mirror', 'faucet',
         'bicycle', 'bread', 'high heels', 'ring', 'van', 'watch', 'sink',
         'horse', 'fish', 'apple', 'camera', 'candle', 'teddy bear', 'cake',
         'motorcycle', 'wild bird', 'laptop', 'knife', 'traffic sign',
         'cell phone', 'paddle', 'truck', 'cow', 'power outlet', 'clock',
         'drum', 'fork', 'bus', 'hanger', 'nightstand', 'pot/pan', 'sheep',
         'guitar', 'traffic cone', 'tea pot', 'keyboard', 'tripod', 'hockey',
         'fan', 'dog', 'spoon', 'blackboard/whiteboard', 'balloon',
         'air conditioner', 'cymbal', 'mouse', 'telephone', 'pickup truck',
         'orange', 'banana', 'airplane', 'luggage', 'skis', 'soccer',
         'trolley', 'oven', 'remote', 'baseball glove', 'paper towel',
         'refrigerator', 'train', 'tomato', 'machinery vehicle', 'tent',
         'shampoo/shower gel', 'head phone', 'lantern', 'donut',
         'cleaning products', 'sailboat', 'tangerine', 'pizza', 'kite',
         'computer box', 'elephant', 'toiletries', 'gas stove', 'broccoli',
         'toilet', 'stroller', 'shovel', 'baseball bat', 'microwave',
         'skateboard', 'surfboard', 'surveillance camera', 'gun', 'life saver',
         'cat', 'lemon', 'liquid soap', 'zebra', 'duck', 'sports car',
         'giraffe', 'pumpkin', 'piano', 'stop sign', 'radiator', 'converter',
         'tissue ', 'carrot', 'washing machine', 'vent', 'cookies',
         'cutting/chopping board', 'tennis racket', 'candy',
         'skating and skiing shoes', 'scissors', 'folder', 'baseball',
         'strawberry', 'bow tie', 'pigeon', 'pepper', 'coffee machine',
         'bathtub', 'snowboard', 'suitcase', 'grapes', 'ladder', 'pear',
         'american football', 'basketball', 'potato', 'paint brush', 'printer',
         'billiards', 'fire hydrant', 'goose', 'projector', 'sausage',
         'fire extinguisher', 'extension cord', 'facial mask', 'tennis ball',
         'chopsticks', 'electronic stove and gas stove', 'pie', 'frisbee',
         'kettle', 'hamburger', 'golf club', 'cucumber', 'clutch', 'blender',
         'tong', 'slide', 'hot dog', 'toothbrush', 'facial cleanser', 'mango',
         'deer', 'egg', 'violin', 'marker', 'ship', 'chicken', 'onion',
         'ice cream', 'tape', 'wheelchair', 'plum', 'bar soap', 'scale',
         'watermelon', 'cabbage', 'router/modem', 'golf ball', 'pine apple',
         'crane', 'fire truck', 'peach', 'cello', 'notepaper', 'tricycle',
         'toaster', 'helicopter', 'green beans', 'brush', 'carriage', 'cigar',
         'earphone', 'penguin', 'hurdle', 'swing', 'radio', 'CD',
         'parking meter', 'swan', 'garlic', 'french fries', 'horn', 'avocado',
         'saxophone', 'trumpet', 'sandwich', 'cue', 'kiwi fruit', 'bear',
         'fishing rod', 'cherry', 'tablet', 'green vegetables', 'nuts', 'corn',
         'key', 'screwdriver', 'globe', 'broom', 'pliers', 'volleyball',
         'hammer', 'eggplant', 'trophy', 'dates', 'board eraser', 'rice',
         'tape measure/ruler', 'dumbbell', 'hamimelon', 'stapler', 'camel',
         'lettuce', 'goldfish', 'meat balls', 'medal', 'toothpaste',
         'antelope', 'shrimp', 'rickshaw', 'trombone', 'pomegranate',
         'coconut', 'jellyfish', 'mushroom', 'calculator', 'treadmill',
         'butterfly', 'egg tart', 'cheese', 'pig', 'pomelo', 'race car',
         'rice cooker', 'tuba', 'crosswalk sign', 'papaya', 'hair drier',
         'green onion', 'chips', 'dolphin', 'sushi', 'urinal', 'donkey',
         'electric drill', 'spring rolls', 'tortoise/turtle', 'parrot',
         'flute', 'measuring cup', 'shark', 'steak', 'poker card',
         'binoculars', 'llama', 'radish', 'noodles', 'yak', 'mop', 'crab',
         'microscope', 'barbell', 'bread/bun', 'baozi', 'lion', 'red cabbage',
         'polar bear', 'lighter', 'seal', 'mangosteen', 'comb', 'eraser',
         'pitaya', 'scallop', 'pencil case', 'saw', 'table tennis paddle',
         'okra', 'starfish', 'eagle', 'monkey', 'durian', 'game board',
         'rabbit', 'french horn', 'ambulance', 'asparagus', 'hoverboard',
         'pasta', 'target', 'hotair balloon', 'chainsaw', 'lobster', 'iron',
         'flashlight']

    CLASSES_NAMES = ['person', 'sneakers', 'chair', 'hat', 'lamp', 'bottle',
         'cabinet/shelf', 'cup', 'car', 'glasses', 'picture/frame', 'desk',
         'handbag', 'street lights', 'book', 'plate', 'helmet',
         'leather shoes', 'pillow', 'glove', 'potted plant', 'bracelet',
         'flower', 'tv', 'storage box', 'vase', 'bench', 'wine glass', 'boots',
         'bowl', 'dining table', 'umbrella', 'boat', 'flag', 'speaker',
         'trash bin/can', 'stool', 'backpack', 'couch', 'belt', 'carpet',
         'basket', 'towel/napkin', 'slippers', 'barrel/bucket', 'coffee table',
         'suv', 'toy', 'tie', 'bed', 'traffic light', 'pen/pencil',
         'microphone', 'sandals', 'canned', 'necklace', 'mirror', 'faucet',
         'bicycle', 'bread', 'high heels', 'ring', 'van', 'watch', 'sink',
         'horse', 'fish', 'apple', 'camera', 'candle', 'teddy bear', 'cake',
         'motorcycle', 'wild bird', 'laptop', 'knife', 'traffic sign',
         'cell phone', 'paddle', 'truck', 'cow', 'power outlet', 'clock',
         'drum', 'fork', 'bus', 'hanger', 'nightstand', 'pot/pan', 'sheep',
         'guitar', 'traffic cone', 'tea pot', 'keyboard', 'tripod', 'hockey',
         'fan', 'dog', 'spoon', 'blackboard/whiteboard', 'balloon',
         'air conditioner', 'cymbal', 'mouse', 'telephone', 'pickup truck',
         'orange', 'banana', 'airplane', 'luggage', 'skis', 'soccer',
         'trolley', 'oven', 'remote', 'baseball glove', 'paper towel',
         'refrigerator', 'train', 'tomato', 'machinery vehicle', 'tent',
         'shampoo/shower gel', 'head phone', 'lantern', 'donut',
         'cleaning products', 'sailboat', 'tangerine', 'pizza', 'kite',
         'computer box', 'elephant', 'toiletries', 'gas stove', 'broccoli',
         'toilet', 'stroller', 'shovel', 'baseball bat', 'microwave',
         'skateboard', 'surfboard', 'surveillance camera', 'gun', 'life saver',
         'cat', 'lemon', 'liquid soap', 'zebra', 'duck', 'sports car',
         'giraffe', 'pumpkin', 'piano', 'stop sign', 'radiator', 'converter',
         'tissue ', 'carrot', 'washing machine', 'vent', 'cookies',
         'cutting/chopping board', 'tennis racket', 'candy',
         'skating and skiing shoes', 'scissors', 'folder', 'baseball',
         'strawberry', 'bow tie', 'pigeon', 'pepper', 'coffee machine',
         'bathtub', 'snowboard', 'suitcase', 'grapes', 'ladder', 'pear',
         'american football', 'basketball', 'potato', 'paint brush', 'printer',
         'billiards', 'fire hydrant', 'goose', 'projector', 'sausage',
         'fire extinguisher', 'extension cord', 'facial mask', 'tennis ball',
         'chopsticks', 'electronic stove and gas stove', 'pie', 'frisbee',
         'kettle', 'hamburger', 'golf club', 'cucumber', 'clutch', 'blender',
         'tong', 'slide', 'hot dog', 'toothbrush', 'facial cleanser', 'mango',
         'deer', 'egg', 'violin', 'marker', 'ship', 'chicken', 'onion',
         'ice cream', 'tape', 'wheelchair', 'plum', 'bar soap', 'scale',
         'watermelon', 'cabbage', 'router/modem', 'golf ball', 'pine apple',
         'crane', 'fire truck', 'peach', 'cello', 'notepaper', 'tricycle',
         'toaster', 'helicopter', 'green beans', 'brush', 'carriage', 'cigar',
         'earphone', 'penguin', 'hurdle', 'swing', 'radio', 'CD',
         'parking meter', 'swan', 'garlic', 'french fries', 'horn', 'avocado',
         'saxophone', 'trumpet', 'sandwich', 'cue', 'kiwi fruit', 'bear',
         'fishing rod', 'cherry', 'tablet', 'green vegetables', 'nuts', 'corn',
         'key', 'screwdriver', 'globe', 'broom', 'pliers', 'volleyball',
         'hammer', 'eggplant', 'trophy', 'dates', 'board eraser', 'rice',
         'tape measure/ruler', 'dumbbell', 'hamimelon', 'stapler', 'camel',
         'lettuce', 'goldfish', 'meat balls', 'medal', 'toothpaste',
         'antelope', 'shrimp', 'rickshaw', 'trombone', 'pomegranate',
         'coconut', 'jellyfish', 'mushroom', 'calculator', 'treadmill',
         'butterfly', 'egg tart', 'cheese', 'pig', 'pomelo', 'race car',
         'rice cooker', 'tuba', 'crosswalk sign', 'papaya', 'hair drier',
         'green onion', 'chips', 'dolphin', 'sushi', 'urinal', 'donkey',
         'electric drill', 'spring rolls', 'tortoise/turtle', 'parrot',
         'flute', 'measuring cup', 'shark', 'steak', 'poker card',
         'binoculars', 'llama', 'radish', 'noodles', 'yak', 'mop', 'crab',
         'microscope', 'barbell', 'bread/bun', 'baozi', 'lion', 'red cabbage',
         'polar bear', 'lighter', 'seal', 'mangosteen', 'comb', 'eraser',
         'pitaya', 'scallop', 'pencil case', 'saw', 'table tennis paddle',
         'okra', 'starfish', 'eagle', 'monkey', 'durian', 'game board',
         'rabbit', 'french horn', 'ambulance', 'asparagus', 'hoverboard',
         'pasta', 'target', 'hotair balloon', 'chainsaw', 'lobster', 'iron',
         'flashlight']
    
    PALETTE = None

    def __init__(self,
                 data_root=DATASET_ZOO['object365'],
                 raw_train_json_file='annos/object365/objects365_train.json',
                 raw_val_json_file='annos/object365/objects365_val.json') -> None:
        file_dir = os.path.dirname(os.path.abspath(__file__))
        raw_train_json_file = os.path.join(file_dir,raw_train_json_file)
        raw_val_json_file = os.path.join(file_dir,raw_val_json_file)
        super().__init__(
            data_root=data_root,
            raw_train_json_file=raw_train_json_file,
            raw_val_json_file=raw_val_json_file,
            dataset_name='Object365',
            tag='object365',
            train_data_prefix=dict(img='train/'),
            val_data_prefix=dict(img='val/')
        )

if __name__=='__main__':
    objects =["fire hydrant"]
    dataset = DatasetObject365Detection()
    tar2label = dataset.search(objects)
    print(tar2label)
